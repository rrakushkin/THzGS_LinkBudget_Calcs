function gamma_w = specificAttenuationWaterVapor(f, T, p, e)
    %SPECIFICATTENUATIONWATERVAPOR Provides the specific attenuation due to water vapor from Rec. ITU-R P.676.
    %
    % Input:
    %   f          [GHz] Frequency. VALID RANGE: (1, 1000) GHz.
    %   T          [K] Temperature.
    %   p          [hPa] Dry air pressure.
    %   e          [hPa] Water vapor partial pressure.
    %
    % Output:
    %   gamma_w    [dB/km] Water vapor specific attenuation.

    % Spectroscopic data for water vapor (Table 2).
    f0 = [22.235080, 67.803960, 119.995940, 183.310087, 321.225630, 325.152888, 336.227764, 380.197353, 390.134508, 437.346667, 439.150807, 443.018343, 448.001085, 470.888999, 474.689092, 488.490108, 503.568532, 504.482692, 547.676440, 552.020960, 556.935985, 620.700807, 645.766085, 658.005280, 752.033113, 841.051732, 859.965698, 899.303175, 902.611085, 906.205957, 916.171582, 923.112692, 970.315022, 987.926764, 1780.000000];
    b1 = [0.1079, 0.0011, 0.0007, 2.273, 0.0470, 1.514, 0.0010, 11.67, 0.0045, 0.0632, 0.9098, 0.1920, 10.41, 0.3254, 1.260, 0.2529, 0.0372, 0.0124, 0.9785, 0.1840, 497.0, 5.015, 0.0067, 0.2732, 243.4, 0.0134, 0.1325, 0.0547, 0.0386, 0.1836, 8.400, 0.0079, 9.009, 134.6, 17506.0];
    b2 = [2.144, 8.732, 8.353, 0.668, 6.179, 1.541, 9.825, 1.048, 7.347, 5.048, 3.595, 5.048, 1.405, 3.597, 2.379, 2.852, 6.731, 6.731, 0.158, 0.158, 0.159, 2.391, 8.633, 7.816, 0.396, 8.177, 8.055, 7.914, 8.429, 5.110, 1.441, 10.293, 1.919, 0.257, 0.952];
    b3 = [26.38, 28.58, 29.48, 29.06, 24.04, 28.23, 26.93, 28.11, 21.52, 18.45, 20.07, 15.55, 25.64, 21.34, 23.20, 25.86, 16.12, 16.12, 26.00, 26.00, 30.86, 24.38, 18.00, 32.10, 30.86, 15.90, 30.60, 29.85, 28.65, 24.08, 26.73, 29.00, 25.50, 29.85, 196.3];
    b4 = [0.76, 0.69, 0.70, 0.77, 0.67, 0.64, 0.69, 0.54, 0.63, 0.60, 0.63, 0.60, 0.66, 0.66, 0.65, 0.69, 0.61, 0.61, 0.70, 0.70, 0.69, 0.71, 0.60, 0.69, 0.68, 0.33, 0.68, 0.68, 0.70, 0.70, 0.70, 0.70, 0.64, 0.68, 2.00];
    b5 = [5.087, 4.930, 4.780, 5.022, 4.398, 4.893, 4.740, 5.063, 4.810, 4.230, 4.483, 5.083, 5.028, 4.506, 4.804, 5.201, 3.980, 4.010, 4.500, 4.500, 4.552, 4.856, 4.000, 4.140, 4.352, 5.760, 4.090, 4.530, 5.100, 4.700, 5.150, 5.000, 4.940, 4.550, 24.15];
    b6 = [1.00, 0.82, 0.79, 0.85, 0.54, 0.74, 0.61, 0.89, 0.55, 0.48, 0.52, 0.50, 0.67, 0.65, 0.64, 0.72, 0.43, 0.45, 1.00, 1.00, 1.00, 0.68, 0.50, 1.00, 0.84, 0.45, 0.84, 0.90, 0.95, 0.53, 0.78, 0.80, 0.67, 0.90, 5.00];

    theta = 300 / T;

    Delta_f = b3 * 1e-4 .* (p * theta .^ b4 + b5 * e .* theta .^ b6); % Width of the water vapor lines (Eq. 6a).
    % Doppler broadening of water vapor lines (Eq. 6b).
    Delta_f = 0.535 * Delta_f + sqrt(0.217 * Delta_f .^ 2 + 2.1316e-12 * f0 .^2 / theta);

    % Line-shape factor (Eq. 5).
    F = f ./ f0 .* (Delta_f ./ ((f0 - f) .^ 2 + Delta_f .^ 2) + Delta_f ./ ((f0 + f) .^2 + Delta_f .^ 2));

    % Line strength for water vapor (Eq. 3).
    S = b1 * 1e-1 * e * theta ^ 3.5 .* exp(b2 * (1 - theta));

    N_water = S * F'; % Imaginary part of the frequency-dependant complex refractivity (Eq. 2a).

    gamma_w = 0.1820 * f * N_water; % [dB/km] Water vapor specific attenuation (Eq. 1).
end

